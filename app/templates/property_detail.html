{% extends 'base.html' %}
{% load static %}

{% block title %}{{ property.title }} - StayBooking{% endblock %}

{% block extra_css %}
<style>
:root {
    --detail-primary: #667eea;
    --detail-secondary: #764ba2;
    --detail-accent: #f093fb;
    --detail-success: #4facfe;
    --detail-warning: #f8b500;
    --detail-danger: #ff6b6b;
    --detail-light: #f8f9fa;
    --detail-dark: #2d3748;
    --detail-gray: #718096;
    --detail-border: #e2e8f0;
    --detail-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    --detail-shadow-hover: 0 20px 60px rgba(0, 0, 0, 0.15);
    --detail-radius: 20px;
    --detail-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Property Header */
.property-header {
    padding: 2rem 0;
    border-bottom: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.property-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--detail-dark);
    margin-bottom: 1rem;
    line-height: 1.2;
}

.property-meta {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    flex-wrap: wrap;
    margin-bottom: 1rem;
}

.rating-badge {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: white;
    padding: 0.5rem 1rem;
    border-radius: 25px;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
}

.rating-badge i {
    color: #F6AD55;
}

.rating-badge .rating-number {
    font-weight: 700;
    color: var(--detail-dark);
}

.rating-badge .review-count {
    color: var(--detail-gray);
    text-decoration: underline;
    cursor: pointer;
}

.location-badge {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--detail-gray);
    font-weight: 500;
}

.location-badge i {
    color: var(--detail-primary);
}

.superhost-badge {
    background: linear-gradient(135deg, var(--detail-success), #00f2fe);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.property-actions {
    display: flex;
    gap: 1rem;
    align-items: center;
}

.action-btn {
    background: white;
    border: 2px solid var(--detail-border);
    border-radius: 12px;
    padding: 0.75rem 1rem;
    font-weight: 500;
    color: var(--detail-dark);
    transition: var(--detail-transition);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
}

.action-btn:hover {
    border-color: var(--detail-primary);
    color: var(--detail-primary);
    transform: translateY(-1px);
}

.action-btn.share {
    color: var(--detail-gray);
}

.action-btn.wishlist {
    color: var(--detail-danger);
}

/* Image Gallery */
.image-gallery {
    border-radius: var(--detail-radius);
    overflow: hidden;
    margin-bottom: 3rem;
    position: relative;
    box-shadow: var(--detail-shadow);
}

.main-image-container {
    position: relative;
    height: 500px;
    overflow: hidden;
}

.main-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
}

.image-navigation {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: var(--detail-dark);
    transition: var(--detail-transition);
    backdrop-filter: blur(10px);
    z-index: 10;
}

.image-navigation:hover {
    background: white;
    transform: translateY(-50%) scale(1.1);
    box-shadow: var(--detail-shadow);
}

.nav-prev {
    left: 20px;
}

.nav-next {
    right: 20px;
}

.image-counter {
    position: absolute;
    bottom: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 500;
    backdrop-filter: blur(10px);
}

.gallery-thumbnails {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
    gap: 0.5rem;
    margin-top: 1rem;
    max-height: 100px;
    overflow-x: auto;
    padding: 0.5rem 0;
}

.thumbnail {
    width: 80px;
    height: 60px;
    object-fit: cover;
    border-radius: 8px;
    cursor: pointer;
    opacity: 0.7;
    transition: var(--detail-transition);
    border: 2px solid transparent;
}

.thumbnail.active,
.thumbnail:hover {
    opacity: 1;
    border-color: var(--detail-primary);
    transform: scale(1.05);
}

.show-all-photos {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background: white;
    border: none;
    border-radius: 12px;
    padding: 0.75rem 1.25rem;
    font-weight: 600;
    color: var(--detail-dark);
    transition: var(--detail-transition);
    box-shadow: var(--detail-shadow);
}

.show-all-photos:hover {
    transform: translateY(-2px);
    box-shadow: var(--detail-shadow-hover);
}

/* Content Layout */
.property-content {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 3rem;
    margin-bottom: 3rem;
}

.main-content {
    /* Main content styles */
}

.booking-sidebar {
    position: sticky;
    top: 120px;
    height: fit-content;
}

/* Host Information */
.host-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.host-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.host-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid white;
    box-shadow: var(--detail-shadow);
}

.host-info h4 {
    margin: 0;
    color: var(--detail-dark);
    font-weight: 700;
}

.host-info .host-meta {
    color: var(--detail-gray);
    font-size: 0.9rem;
    margin-top: 0.25rem;
}

.property-basics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.basic-item {
    text-align: center;
    padding: 1rem;
    background: var(--detail-light);
    border-radius: 12px;
    border: 1px solid var(--detail-border);
}

.basic-item i {
    color: var(--detail-primary);
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.basic-item .label {
    font-size: 0.875rem;
    color: var(--detail-gray);
    font-weight: 500;
}

.basic-item .value {
    font-weight: 700;
    color: var(--detail-dark);
}

/* Description */
.description-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.section-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--detail-dark);
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.section-title i {
    color: var(--detail-primary);
}

.description-text {
    line-height: 1.7;
    color: var(--detail-gray);
    font-size: 1rem;
}

.read-more-btn {
    background: none;
    border: none;
    color: var(--detail-primary);
    font-weight: 600;
    cursor: pointer;
    text-decoration: underline;
    margin-top: 1rem;
}

/* Highlights */
.highlights-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.highlights-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
}

.highlight-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1.5rem;
    background: var(--detail-light);
    border-radius: 15px;
    border: 1px solid var(--detail-border);
    transition: var(--detail-transition);
}

.highlight-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--detail-shadow);
}

.highlight-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--detail-primary), var(--detail-secondary));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
    flex-shrink: 0;
}

.highlight-content h5 {
    margin: 0 0 0.5rem 0;
    color: var(--detail-dark);
    font-weight: 600;
}

.highlight-content p {
    margin: 0;
    color: var(--detail-gray);
    font-size: 0.9rem;
    line-height: 1.5;
}

/* Amenities */
.amenities-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.amenities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}

.amenity-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--detail-light);
    border-radius: 12px;
    border: 1px solid var(--detail-border);
    transition: var(--detail-transition);
}

.amenity-item:hover {
    background: rgba(102, 126, 234, 0.05);
    border-color: var(--detail-primary);
}

.amenity-icon {
    width: 40px;
    height: 40px;
    background: white;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--detail-primary);
    font-size: 1.1rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    flex-shrink: 0;
}

.amenity-name {
    font-weight: 500;
    color: var(--detail-dark);
}

.show-all-amenities {
    display: block;
    margin: 1.5rem auto 0;
    background: transparent;
    border: 2px solid var(--detail-primary);
    color: var(--detail-primary);
    border-radius: 12px;
    padding: 0.75rem 2rem;
    font-weight: 600;
    transition: var(--detail-transition);
}

.show-all-amenities:hover {
    background: var(--detail-primary);
    color: white;
}

/* Booking Card */
.booking-card {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow-hover);
    border: 1px solid var(--detail-border);
    position: sticky;
    top: 120px;
}

.booking-header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--detail-border);
}

.price-display {
    font-size: 2rem;
    font-weight: 700;
    color: var(--detail-dark);
    margin-bottom: 0.5rem;
}

.price-display .currency {
    font-size: 1.5rem;
}

.price-display .per-night {
    font-size: 1rem;
    font-weight: 400;
    color: var(--detail-gray);
}

.booking-rating {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    color: var(--detail-gray);
    font-size: 0.9rem;
}

.booking-rating i {
    color: #F6AD55;
}

.booking-form {
    margin-bottom: 2rem;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    font-weight: 600;
    color: var(--detail-dark);
    margin-bottom: 0.75rem;
    display: block;
}

.date-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.form-input {
    width: 100%;
    border: 2px solid var(--detail-border);
    border-radius: 12px;
    padding: 1rem;
    font-size: 1rem;
    transition: var(--detail-transition);
    background: white;
}

.form-input:focus {
    border-color: var(--detail-primary);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    outline: none;
}

.guests-selector {
    position: relative;
}

.guests-dropdown {
    border: 2px solid var(--detail-border);
    border-radius: 12px;
    padding: 1rem;
    background: white;
    cursor: pointer;
    transition: var(--detail-transition);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.guests-dropdown:hover,
.guests-dropdown.active {
    border-color: var(--detail-primary);
}

.guests-menu {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 2px solid var(--detail-border);
    border-radius: 12px;
    box-shadow: var(--detail-shadow);
    z-index: 100;
    padding: 1rem;
    display: none;
}

.guests-menu.show {
    display: block;
}

.guest-counter {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.guest-counter:last-child {
    margin-bottom: 0;
}

.guest-label {
    font-weight: 500;
    color: var(--detail-dark);
}

.guest-controls {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.counter-btn {
    width: 35px;
    height: 35px;
    border: 2px solid var(--detail-border);
    border-radius: 50%;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--detail-transition);
    font-weight: 600;
    color: var(--detail-dark);
}

.counter-btn:hover:not(:disabled) {
    border-color: var(--detail-primary);
    color: var(--detail-primary);
}

.counter-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.counter-value {
    font-weight: 600;
    min-width: 20px;
    text-align: center;
    color: var(--detail-dark);
}

.price-breakdown {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: var(--detail-light);
    border-radius: 15px;
    border: 1px solid var(--detail-border);
}

.price-line {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    color: var(--detail-gray);
}

.price-line:last-child {
    margin-bottom: 0;
    font-weight: 700;
    color: var(--detail-dark);
    font-size: 1.1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--detail-border);
}

.nights-display {
    font-weight: 500;
}

.reserve-btn {
    width: 100%;
    background: linear-gradient(135deg, var(--detail-primary), var(--detail-secondary));
    color: white;
    border: none;
    border-radius: 12px;
    padding: 1.25rem;
    font-size: 1.1rem;
    font-weight: 700;
    transition: var(--detail-transition);
    margin-bottom: 1rem;
}

.reserve-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
}

.reserve-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.booking-note {
    text-align: center;
    color: var(--detail-gray);
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.contact-host-btn {
    width: 100%;
    background: white;
    border: 2px solid var(--detail-border);
    color: var(--detail-dark);
    border-radius: 12px;
    padding: 1rem;
    font-weight: 600;
    transition: var(--detail-transition);
}

.contact-host-btn:hover {
    border-color: var(--detail-primary);
    color: var(--detail-primary);
}

/* Reviews Section */
.reviews-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.reviews-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.reviews-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-item {
    text-align: center;
    padding: 1rem;
    background: var(--detail-light);
    border-radius: 12px;
    border: 1px solid var(--detail-border);
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--detail-primary);
    margin-bottom: 0.25rem;
}

.stat-label {
    color: var(--detail-gray);
    font-size: 0.875rem;
    font-weight: 500;
}

.reviews-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.review-card {
    background: var(--detail-light);
    border-radius: 15px;
    padding: 1.5rem;
    border: 1px solid var(--detail-border);
    transition: var(--detail-transition);
}

.review-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--detail-shadow);
}

.review-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.reviewer-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.reviewer-info h6 {
    margin: 0;
    color: var(--detail-dark);
    font-weight: 600;
}

.review-date {
    color: var(--detail-gray);
    font-size: 0.875rem;
}

.review-rating {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.review-rating i {
    color: #F6AD55;
    font-size: 0.875rem;
}

.review-text {
    color: var(--detail-gray);
    line-height: 1.6;
    margin: 0;
}

.show-all-reviews {
    display: block;
    margin: 2rem auto 0;
    background: transparent;
    border: 2px solid var(--detail-primary);
    color: var(--detail-primary);
    border-radius: 12px;
    padding: 0.75rem 2rem;
    font-weight: 600;
    transition: var(--detail-transition);
}

.show-all-reviews:hover {
    background: var(--detail-primary);
    color: white;
}

/* Location Section */
.location-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.location-description {
    color: var(--detail-gray);
    line-height: 1.6;
    margin-bottom: 2rem;
}

.map-container {
    height: 400px;
    border-radius: 15px;
    overflow: hidden;
    border: 1px solid var(--detail-border);
    position: relative;
}

#map {
    width: 100%;
    height: 100%;
}

.map-overlay {
    position: absolute;
    top: 15px;
    left: 15px;
    background: rgba(255, 255, 255, 0.9);
    padding: 0.75rem 1rem;
    border-radius: 10px;
    backdrop-filter: blur(10px);
    font-weight: 500;
    color: var(--detail-dark);
    z-index: 10;
}

/* Host Profile */
.host-profile-section {
    background: white;
    border-radius: var(--detail-radius);
    padding: 2rem;
    box-shadow: var(--detail-shadow);
    border: 1px solid var(--detail-border);
    margin-bottom: 2rem;
}

.host-profile-header {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.host-large-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid white;
    box-shadow: var(--detail-shadow);
}

.host-details h3 {
    margin: 0 0 0.5rem 0;
    color: var(--detail-dark);
    font-weight: 700;
}

.host-joined {
    color: var(--detail-gray);
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.host-badges {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.host-badge {
    background: linear-gradient(135deg, var(--detail-success), #00f2fe);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 600;
}

.host-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.host-stat {
    text-align: center;
    padding: 1rem;
    background: var(--detail-light);
    border-radius: 12px;
    border: 1px solid var(--detail-border);
}

.host-stat-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--detail-primary);
    margin-bottom: 0.25rem;
}

.host-stat-label {
    color: var(--detail-gray);
    font-size: 0.875rem;
}

.host-bio {
    color: var(--detail-gray);
    line-height: 1.6;
    margin-bottom: 2rem;
}

.contact-host-section {
    text-align: center;
}

/* Responsive Design */
@media (max-width: 1200px) {
    .property-content {
        grid-template-columns: 1fr 350px;
    }
}

@media (max-width: 992px) {
    .property-content {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .booking-sidebar {
        position: static;
        order: -1;
    }
    
    .booking-card {
        position: static;
    }
}

@media (max-width: 768px) {
    .property-title {
        font-size: 2rem;
    }
    
    .property-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }
    
    .property-actions {
        width: 100%;
        justify-content: space-between;
    }
    
    .main-image-container {
        height: 300px;
    }
    
    .date-inputs {
        grid-template-columns: 1fr;
    }
    
    .amenities-grid {
        grid-template-columns: 1fr;
    }
    
    .reviews-grid {
        grid-template-columns: 1fr;
    }
    
    .host-profile-header {
        flex-direction: column;
        text-align: center;
    }
}

/* Modal Styles */
.photo-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.9);
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
}

.photo-modal.show {
    display: flex;
}

.modal-content {
    max-width: 90vw;
    max-height: 90vh;
    position: relative;
}

.modal-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 10px;
}

.modal-close {
    position: absolute;
    top: -50px;
    right: 0;
    background: none;
    border: none;
    color: white;
    font-size: 2rem;
    cursor: pointer;
}

.modal-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.2);
    border: none;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    transition: var(--detail-transition);
    backdrop-filter: blur(10px);
}

.modal-nav:hover {
    background: rgba(255, 255, 255, 0.3);
}

.modal-nav.prev {
    left: -80px;
}

.modal-nav.next {
    right: -80px;
}

/* Animations */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.fade-in {
    animation: fadeIn 0.6s ease-out;
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.slide-in-right {
    animation: slideInRight 0.6s ease-out;
}

/* Loading States */
.loading-skeleton {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
}

@keyframes loading {
    0% {
        background-position: 200% 0;
    }
    100% {
        background-position: -200% 0;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- Property Header -->
<div class="container">
    <div class="property-header fade-in">
        <h1 class="property-title">{{ property.title }}</h1>
        <div class="property-meta">
            <div class="rating-badge">
                <i class="fas fa-star"></i>
                <span class="rating-number">4.{{ property.id|add:5 }}</span>
                <span class="review-count">({{ property.reviews.count }} reviews)</span>
            </div>
            <div class="location-badge">
                <i class="fas fa-map-marker-alt"></i>
                <span>{{ property.location }}</span>
            </div>
            {% if property.is_superhost %}
            <div class="superhost-badge">
                <i class="fas fa-medal"></i>
                <span>Superhost</span>
            </div>
            {% endif %}
        </div>
        <div class="property-actions">
            <button class="action-btn share" onclick="shareProperty()">
                <i class="fas fa-share"></i>
                <span>Share</span>
            </button>
            <button class="action-btn wishlist" onclick="toggleWishlist('{{ property.id }}')">
                <i class="far fa-heart"></i>
                <span>Save</span>
            </button>
        </div>
    </div>

    <!-- Image Gallery -->
    <div class="image-gallery fade-in">
        <div class="main-image-container">
            {% if property.images.all %}
                <img src="{{ property.images.first.image.url }}" alt="{{ property.title }}" class="main-image" id="mainImage">
                <button class="image-navigation nav-prev" onclick="changeImage(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="image-navigation nav-next" onclick="changeImage(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div class="image-counter">
                    <span id="currentImageIndex">1</span> / {{ property.images.count }}
                </div>
            {% else %}
                <img src="{% static 'images/default-property.jpg' %}" alt="No image available" class="main-image">
            {% endif %}
            <button class="show-all-photos" onclick="openPhotoModal()">
                <i class="fas fa-images me-2"></i>Show all photos
            </button>
        </div>
        
        {% if property.images.count > 1 %}
        <div class="gallery-thumbnails">
            {% for image in property.images.all %}
            <img src="{{ image.image.url }}" alt="Property image" class="thumbnail {% if forloop.first %}active{% endif %}" 
                 onclick="selectImage('{{ forloop.counter0 }}')">
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <!-- Property Content -->
    <div class="property-content">
        <div class="main-content">
            <!-- Host Section -->
            <div class="host-section fade-in">
                <div class="host-header">
                    {% if property.host.userprofile.avatar %}
                        <img src="{{ property.host.userprofile.avatar.url }}" alt="{{ property.host.get_full_name }}" class="host-avatar">
                    {% else %}
                        <img src="{% static 'images/default-avatar.svg' %}" alt="Host avatar" class="host-avatar">
                    {% endif %}
                    <div class="host-info">
                        <h4>Hosted by {{ property.host.get_full_name|default:property.host.username }}</h4>
                        <div class="host-meta">
                            <span>{{ property.get_property_type_display }}</span> • 
                            <span>{{ property.get_space_type_display }}</span>
                        </div>
                    </div>
                </div>
                
                <div class="property-basics">
                    <div class="basic-item">
                        <i class="fas fa-users"></i>
                        <div class="value">{{ property.max_guests }}</div>
                        <div class="label">guest{{ property.max_guests|pluralize }}</div>
                    </div>
                    <div class="basic-item">
                        <i class="fas fa-bed"></i>
                        <div class="value">{{ property.bedrooms }}</div>
                        <div class="label">bedroom{{ property.bedrooms|pluralize }}</div>
                    </div>
                    <div class="basic-item">
                        <i class="fas fa-bath"></i>
                        <div class="value">{{ property.bathrooms }}</div>
                        <div class="label">bathroom{{ property.bathrooms|pluralize }}</div>
                    </div>
                    <div class="basic-item">
                        <i class="fas fa-bed"></i>
                        <div class="value">{{ property.beds }}</div>
                        <div class="label">bed{{ property.beds|pluralize }}</div>
                    </div>
                </div>
            </div>

            <!-- Description -->
            <div class="description-section fade-in">
                <h3 class="section-title">
                    <i class="fas fa-info-circle"></i>
                    About this place
                </h3>
                <div class="description-text" id="description">
                    {{ property.description|linebreaks }}
                </div>
                {% if property.description|length > 300 %}
                <button class="read-more-btn" onclick="toggleDescription()">Read more</button>
                {% endif %}
            </div>

            <!-- Highlights -->
            {% if property.get_highlights_list %}
            <div class="highlights-section fade-in">
                <h3 class="section-title">
                    <i class="fas fa-sparkles"></i>
                    What makes this place special
                </h3>
                <div class="highlights-grid">
                    {% for highlight in property.get_highlights_list %}
                    <div class="highlight-item">
                        <div class="highlight-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="highlight-content">
                            <h5>{{ highlight|title }}</h5>
                            <p>This property stands out for its {{ highlight|lower }} atmosphere and unique character.</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Amenities -->
            <div class="amenities-section fade-in">
                <h3 class="section-title">
                    <i class="fas fa-star"></i>
                    What this place offers
                </h3>
                <div class="amenities-grid">
                    {% for amenity in property.amenities.all|slice:":8" %}
                    <div class="amenity-item">
                        <div class="amenity-icon">
                            <i class="{{ amenity.icon }}"></i>
                        </div>
                        <div class="amenity-name">{{ amenity.name }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% if property.amenities.count > 8 %}
                <button class="show-all-amenities" onclick="showAllAmenities()">
                    Show all {{ property.amenities.count }} amenities
                </button>
                {% endif %}
            </div>

            <!-- Reviews -->
            <div class="reviews-section fade-in">
                <div class="reviews-header">
                    <h3 class="section-title">
                        <i class="fas fa-star"></i>
                        Reviews
                    </h3>
                </div>
                
                <div class="reviews-stats">
                    <div class="stat-item">
                        <div class="stat-value">4.{{ property.id|add:5 }}</div>
                        <div class="stat-label">Overall Rating</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ property.reviews.count }}</div>
                        <div class="stat-label">Total Reviews</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">100%</div>
                        <div class="stat-label">Recommend</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">5.0</div>
                        <div class="stat-label">Communication</div>
                    </div>
                </div>

                {% if property.reviews.all %}
                <div class="reviews-grid">
                    {% for review in property.reviews.all|slice:":6" %}
                    <div class="review-card">
                        <div class="review-header">
                            {% if review.user.userprofile.avatar %}
                                <img src="{{ review.user.userprofile.avatar.url }}" alt="{{ review.user.get_full_name }}" class="reviewer-avatar">
                            {% else %}
                                <img src="{% static 'images/default-avatar.svg' %}" alt="Reviewer avatar" class="reviewer-avatar">
                            {% endif %}
                            <div class="reviewer-info">
                                <h6>{{ review.user.get_full_name|default:review.user.username }}</h6>
                                <div class="review-date">{{ review.created_at|date:"M Y" }}</div>
                            </div>
                            <div class="review-rating">
                                {% for i in "12345"|make_list %}
                                <i class="fas fa-star {% if forloop.counter <= review.rating %}{% else %}text-muted{% endif %}"></i>
                                {% endfor %}
                            </div>
                        </div>
                        <p class="review-text">{{ review.comment|truncatewords:25 }}</p>
                    </div>
                    {% endfor %}
                </div>
                {% if property.reviews.count > 6 %}
                <button class="show-all-reviews" onclick="showAllReviews()">
                    Show all {{ property.reviews.count }} reviews
                </button>
                {% endif %}
                {% else %}
                <div class="text-center py-4">
                    <p class="text-muted">No reviews yet. Be the first to review this property!</p>
                </div>
                {% endif %}
            </div>

            <!-- Location -->
            <div class="location-section fade-in">
                <h3 class="section-title">
                    <i class="fas fa-map-marker-alt"></i>
                    Where you'll be
                </h3>
                <div class="location-description">
                    <p>{{ property.location }}</p>
                    <p>This location offers easy access to local attractions, restaurants, and transportation. The neighborhood is known for its vibrant atmosphere and convenient amenities.</p>
                </div>
                <div class="map-container">
                    <div id="map"></div>
                    <div class="map-overlay">
                        <i class="fas fa-map-marker-alt me-2"></i>
                        Approximate location
                    </div>
                </div>
            </div>

            <!-- Host Profile -->
            <div class="host-profile-section fade-in">
                <h3 class="section-title">
                    <i class="fas fa-user"></i>
                    Meet your host
                </h3>
                <div class="host-profile-header">
                    {% if property.host.userprofile.avatar %}
                        <img src="{{ property.host.userprofile.avatar.url }}" alt="{{ property.host.get_full_name }}" class="host-large-avatar">
                    {% else %}
                        <img src="{% static 'images/default-avatar.svg' %}" alt="Host avatar" class="host-large-avatar">
                    {% endif %}
                    <div class="host-details">
                        <h3>{{ property.host.get_full_name|default:property.host.username }}</h3>
                        <div class="host-joined">Joined {{ property.host.date_joined|date:"M Y" }}</div>
                        <div class="host-badges">
                            {% if property.is_superhost %}
                            <span class="host-badge">Superhost</span>
                            {% endif %}
                            <span class="host-badge">Verified</span>
                        </div>
                    </div>
                </div>
                
                <div class="host-stats">
                    <div class="host-stat">
                        <div class="host-stat-value">{{ property.host.properties.count }}</div>
                        <div class="host-stat-label">Properties</div>
                    </div>
                    <div class="host-stat">
                        <div class="host-stat-value">4.9</div>
                        <div class="host-stat-label">Rating</div>
                    </div>
                    <div class="host-stat">
                        <div class="host-stat-value">{{ property.host.userprofile.date_joined|timesince|truncatewords:1 }}</div>
                        <div class="host-stat-label">Experience</div>
                    </div>
                </div>
                
                <div class="host-bio">
                    {% if property.host.userprofile.bio %}
                        <p>{{ property.host.userprofile.bio }}</p>
                    {% else %}
                        <p>{{ property.host.get_full_name|default:property.host.username }} is a dedicated host committed to providing exceptional experiences for guests. They respond quickly and ensure every stay is memorable.</p>
                    {% endif %}
                </div>
                
                <div class="contact-host-section">
                    <button class="contact-host-btn" onclick="contactHost()">
                        <i class="fas fa-envelope me-2"></i>Contact Host
                    </button>
                </div>
            </div>
        </div>

        <!-- Booking Sidebar -->
        <div class="booking-sidebar slide-in-right">
            <div class="booking-card">
                <div class="booking-header">
                    <div class="price-display">
                        <span class="currency">$</span>{{ property.price_per_night }}
                        <span class="per-night">/ night</span>
                    </div>
                    <div class="booking-rating">
                        <i class="fas fa-star"></i>
                        <span>4.{{ property.id|add:5 }} • {{ property.reviews.count }} reviews</span>
                    </div>
                </div>

                <form class="booking-form" method="post" action="{% url 'create_booking' property.id %}" id="bookingForm">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <div class="date-inputs">
                            <div>
                                <label class="form-label">CHECK-IN</label>
                                <input type="date" name="check_in" class="form-input" required min="{{ today|date:'Y-m-d' }}" id="checkInDate">
                            </div>
                            <div>
                                <label class="form-label">CHECK-OUT</label>
                                <input type="date" name="check_out" class="form-input" required min="{{ today|date:'Y-m-d' }}" id="checkOutDate">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">GUESTS</label>
                        <div class="guests-selector">
                            <div class="guests-dropdown" onclick="toggleGuestsMenu()">
                                <span id="guestsDisplay">1 guest</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="guests-menu" id="guestsMenu">
                                <div class="guest-counter">
                                    <div class="guest-label">Adults</div>
                                    <div class="guest-controls">
                                        <button type="button" class="counter-btn" onclick="updateGuests('adults', -1)" id="adultsMinusBtn">-</button>
                                        <span class="counter-value" id="adultsCount">1</span>
                                        <button type="button" class="counter-btn" onclick="updateGuests('adults', 1)" id="adultsPlusBtn">+</button>
                                    </div>
                                </div>
                                <div class="guest-counter">
                                    <div class="guest-label">Children</div>
                                    <div class="guest-controls">
                                        <button type="button" class="counter-btn" onclick="updateGuests('children', -1)" id="childrenMinusBtn">-</button>
                                        <span class="counter-value" id="childrenCount">0</span>
                                        <button type="button" class="counter-btn" onclick="updateGuests('children', 1)" id="childrenPlusBtn">+</button>
                                    </div>
                                </div>
                                <div class="guest-counter">
                                    <div class="guest-label">Infants</div>
                                    <div class="guest-controls">
                                        <button type="button" class="counter-btn" onclick="updateGuests('infants', -1)" id="infantsMinusBtn">-</button>
                                        <span class="counter-value" id="infantsCount">0</span>
                                        <button type="button" class="counter-btn" onclick="updateGuests('infants', 1)" id="infantsPlusBtn">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" name="guests" id="totalGuests" value="1">
                    </div>

                    <div class="price-breakdown" id="priceBreakdown" style="display: none;">
                        <div class="price-line">
                            <span>${{ property.price_per_night }} × <span id="nightsCount">0</span> nights</span>
                            <span id="subtotal">$0</span>
                        </div>
                        <div class="price-line">
                            <span>Cleaning fee</span>
                            <span>${{ property.cleaning_fee }}</span>
                        </div>
                        <div class="price-line">
                            <span>Service fee</span>
                            <span>${{ property.service_fee }}</span>
                        </div>
                        <div class="price-line">
                            <span>Total</span>
                            <span id="totalPrice">$0</span>
                        </div>
                    </div>

                    <button type="submit" class="reserve-btn" id="reserveBtn">
                        Pay & Reserve with Stripe
                    </button>
                    <p class="booking-note text-success">Test card: 4242 4242 4242 4242, any future date, any CVC</p>
                    <p class="booking-note">You will be redirected to Stripe for secure payment.</p>
                    
                    <button type="button" class="contact-host-btn" onclick="contactHost()">
                        <i class="fas fa-envelope me-2"></i>Contact Host
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Photo Modal -->
<div class="photo-modal" id="photoModal" onclick="closePhotoModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <button class="modal-close" onclick="closePhotoModal()">&times;</button>
        <img src="" alt="Property photo" class="modal-image" id="modalImage">
        <button class="modal-nav prev" onclick="changeModalImage(-1)">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="modal-nav next" onclick="changeModalImage(1)">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
</div>

<script id="propertyImagesData" type="application/json">[{% for image in property.images.all %}"{{ image.image.url }}"{% if not forloop.last %},{% endif %}{% endfor %}]</script>
{% if property.latitude and property.longitude %}
<script id="propertyCoordsData" type="application/json">{"lat": {{ property.latitude }}, "lng": {{ property.longitude }}}</script>
<script>
function initMap() {
    const location = JSON.parse(document.getElementById('propertyCoordsData').textContent);
    const map = new google.maps.Map(document.getElementById('map'), {
        zoom: 15,
        center: location,
        styles: [
            {
                "featureType": "all",
                "elementType": "geometry.fill",
                "stylers": [{"weight": "2.00"}]
            },
            {
                "featureType": "all",
                "elementType": "geometry.stroke",
                "stylers": [{"color": "#9c9c9c"}]
            },
            {
                "featureType": "all",
                "elementType": "labels.text",
                "stylers": [{"visibility": "on"}]
            }
        ]
    });
    
    new google.maps.Marker({
        position: location,
        map: map,
        title: '{{ property.title }}',
        icon: {
            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                <svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="20" cy="20" r="18" fill="#667eea" stroke="#fff" stroke-width="2"/>
                    <circle cx="20" cy="20" r="8" fill="#fff"/>
                </svg>
            `),
            scaledSize: new google.maps.Size(40, 40)
        }
    });
}
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"></script>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
// Property images data
const propertyImages = JSON.parse(document.getElementById('propertyImagesData').textContent);

let currentImageIndex = 0;
let currentModalIndex = 0;

// Booking calculation variables
const pricePerNight = Number('{{ property.price_per_night }}');
const cleaningFee = Number('{{ property.cleaning_fee }}');
const serviceFee = Number('{{ property.service_fee }}');
const maxGuests = Number('{{ property.max_guests }}');

// Guest counters
let guests = {
    adults: 1,
    children: 0,
    infants: 0
};

document.addEventListener('DOMContentLoaded', function() {
    // Initialize date inputs
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);
    
    document.getElementById('checkInDate').min = today.toISOString().split('T')[0];
    document.getElementById('checkOutDate').min = tomorrow.toISOString().split('T')[0];
    
    // Date change listeners
    document.getElementById('checkInDate').addEventListener('change', updateCheckout);
    document.getElementById('checkOutDate').addEventListener('change', calculateTotal);
    
    // Close guests menu when clicking outside
    document.addEventListener('click', function(e) {
        const guestsMenu = document.getElementById('guestsMenu');
        const guestsDropdown = document.querySelector('.guests-dropdown');
        
        if (!guestsMenu.contains(e.target) && !guestsDropdown.contains(e.target)) {
            guestsMenu.classList.remove('show');
        }
    });
    
    // Initialize guest counters
    updateGuestCounters();
    
    // Initialize scroll animations
    initScrollAnimations();
    
    // Initialize lazy loading
    initLazyLoading();
});

// Image gallery functions
function changeImage(direction) {
    if (propertyImages.length === 0) return;
    
    currentImageIndex += direction;
    if (currentImageIndex < 0) currentImageIndex = propertyImages.length - 1;
    if (currentImageIndex >= propertyImages.length) currentImageIndex = 0;
    
    document.getElementById('mainImage').src = propertyImages[currentImageIndex];
    document.getElementById('currentImageIndex').textContent = currentImageIndex + 1;
    
    // Update thumbnail active state
    document.querySelectorAll('.thumbnail').forEach((thumb, index) => {
        thumb.classList.toggle('active', index === currentImageIndex);
    });
}

function selectImage(index) {
    currentImageIndex = index;
    document.getElementById('mainImage').src = propertyImages[index];
    document.getElementById('currentImageIndex').textContent = index + 1;
    
    document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
        thumb.classList.toggle('active', i === index);
    });
}

// Photo modal functions
function openPhotoModal() {
    const modal = document.getElementById('photoModal');
    const modalImage = document.getElementById('modalImage');
    
    currentModalIndex = currentImageIndex;
    modalImage.src = propertyImages[currentModalIndex];
    modal.classList.add('show');
    document.body.style.overflow = 'hidden';
}

function closePhotoModal() {
    const modal = document.getElementById('photoModal');
    modal.classList.remove('show');
    document.body.style.overflow = '';
}

function changeModalImage(direction) {
    if (propertyImages.length === 0) return;
    
    currentModalIndex += direction;
    if (currentModalIndex < 0) currentModalIndex = propertyImages.length - 1;
    if (currentModalIndex >= propertyImages.length) currentModalIndex = 0;
    
    document.getElementById('modalImage').src = propertyImages[currentModalIndex];
}

// Guests menu functions
function toggleGuestsMenu() {
    const menu = document.getElementById('guestsMenu');
    const dropdown = document.querySelector('.guests-dropdown');
    
    menu.classList.toggle('show');
    dropdown.classList.toggle('active');
}

function updateGuests(type, change) {
    const totalGuests = guests.adults + guests.children;
    
    if (type === 'adults') {
        const newCount = guests.adults + change;
        if (newCount >= 1 && totalGuests + change <= maxGuests) {
            guests.adults = newCount;
        }
    } else if (type === 'children') {
        const newCount = guests.children + change;
        if (newCount >= 0 && totalGuests + change <= maxGuests) {
            guests.children = newCount;
        }
    } else if (type === 'infants') {
        const newCount = guests.infants + change;
        if (newCount >= 0) {
            guests.infants = newCount;
        }
    }
    
    updateGuestCounters();
    updateGuestsDisplay();
}

function updateGuestCounters() {
    document.getElementById('adultsCount').textContent = guests.adults;
    document.getElementById('childrenCount').textContent = guests.children;
    document.getElementById('infantsCount').textContent = guests.infants;
    
    // Update button states
    document.getElementById('adultsMinusBtn').disabled = guests.adults <= 1;
    document.getElementById('childrenMinusBtn').disabled = guests.children <= 0;
    document.getElementById('infantsMinusBtn').disabled = guests.infants <= 0;
    
    const totalGuests = guests.adults + guests.children;
    document.getElementById('adultsPlusBtn').disabled = totalGuests >= maxGuests;
    document.getElementById('childrenPlusBtn').disabled = totalGuests >= maxGuests;
}

function updateGuestsDisplay() {
    const totalGuests = guests.adults + guests.children;
    const infantText = guests.infants > 0 ? `, ${guests.infants} infant${guests.infants > 1 ? 's' : ''}` : '';
    
    document.getElementById('guestsDisplay').textContent = 
        `${totalGuests} guest${totalGuests > 1 ? 's' : ''}${infantText}`;
    document.getElementById('totalGuests').value = totalGuests;
}

// Date and price calculation functions
function updateCheckout() {
    const checkInDate = new Date(document.getElementById('checkInDate').value);
    const checkOutInput = document.getElementById('checkOutDate');
    
    if (checkInDate) {
        const minCheckOut = new Date(checkInDate);
        minCheckOut.setDate(minCheckOut.getDate() + 1);
        checkOutInput.min = minCheckOut.toISOString().split('T')[0];
        
        // Clear checkout if it's before new minimum
        const currentCheckOut = new Date(checkOutInput.value);
        if (currentCheckOut <= checkInDate) {
            checkOutInput.value = '';
        }
    }
    
    calculateTotal();
}

function calculateTotal() {
    const checkIn = document.getElementById('checkInDate').value;
    const checkOut = document.getElementById('checkOutDate').value;
    const breakdown = document.getElementById('priceBreakdown');
    
    if (!checkIn || !checkOut) {
        breakdown.style.display = 'none';
        return;
    }
    
    const checkInDate = new Date(checkIn);
    const checkOutDate = new Date(checkOut);
    const nights = Math.floor((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));
    
    if (nights <= 0) {
        breakdown.style.display = 'none';
        return;
    }
    
    const subtotal = nights * pricePerNight;
    const total = subtotal + cleaningFee + serviceFee;
    
    document.getElementById('nightsCount').textContent = nights;
    document.getElementById('subtotal').textContent = `${subtotal}`;
    document.getElementById('totalPrice').textContent = `${total}`;
    
    breakdown.style.display = 'block';
}

// Other functions
function shareProperty() {
    if (navigator.share) {
        navigator.share({
            title: '{{ property.title }}',
            text: 'Check out this amazing property on StayBooking!',
            url: window.location.href
        });
    } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(window.location.href);
        showNotification('Link copied to clipboard!', 'success');
    }
}

function toggleWishlist(propertyId) {
    const btn = event.target.closest('.action-btn');
    const icon = btn.querySelector('i');
    
    if (icon.classList.contains('far')) {
        icon.classList.remove('far');
        icon.classList.add('fas');
        btn.style.color = 'var(--detail-danger)';
        showNotification('Added to wishlist!', 'success');
    } else {
        icon.classList.remove('fas');
        icon.classList.add('far');
        btn.style.color = '';
        showNotification('Removed from wishlist!', 'info');
    }
}

function contactHost() {
    // Implement contact host functionality
    showNotification('Contact feature coming soon!', 'info');
}

function toggleDescription() {
    const description = document.getElementById('description');
    const btn = event.target;
    
    if (description.style.maxHeight) {
        description.style.maxHeight = '';
        btn.textContent = 'Read more';
    } else {
        description.style.maxHeight = 'none';
        btn.textContent = 'Read less';
    }
}

function showAllAmenities() {
    // Implement show all amenities modal
    showNotification('All amenities modal coming soon!', 'info');
}

function showAllReviews() {
    // Implement show all reviews modal
    showNotification('All reviews modal coming soon!', 'info');
}

// Utility functions
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type} position-fixed`;
    notification.style.cssText = `
        top: 20px;
        right: 20px;
        z-index: 9999;
        max-width: 300px;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease;
    `;
    notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
        ${message}
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.opacity = '1';
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

function initScrollAnimations() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, { threshold: 0.1 });

    document.querySelectorAll('.fade-in, .slide-in-right').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = el.classList.contains('slide-in-right') ? 'translateX(30px)' : 'translateY(20px)';
        el.style.transition = 'all 0.6s ease';
        observer.observe(el);
    });
}

function initLazyLoading() {
    const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.style.opacity = '1';
                observer.unobserve(img);
            }
        });
    });

    document.querySelectorAll('img').forEach(img => {
        img.style.transition = 'opacity 0.3s ease';
        imageObserver.observe(img);
        
        img.addEventListener('load', () => {
            img.style.opacity = '1';
        });
    });
}

// Keyboard navigation
document.addEventListener('keydown', function(e) {
    const modal = document.getElementById('photoModal');
    if (modal.classList.contains('show')) {
        if (e.key === 'Escape') {
            closePhotoModal();
        } else if (e.key === 'ArrowLeft') {
            changeModalImage(-1);
        } else if (e.key === 'ArrowRight') {
            changeModalImage(1);
        }
    } else {
        if (e.key === 'ArrowLeft') {
            changeImage(-1);
        } else if (e.key === 'ArrowRight') {
            changeImage(1);
        }
    }
});

// Form submission
document.getElementById('bookingForm').addEventListener('submit', function(e) {
    const checkIn = document.getElementById('checkInDate').value;
    const checkOut = document.getElementById('checkOutDate').value;
    
    if (!checkIn || !checkOut) {
        e.preventDefault();
        showNotification('Please select check-in and check-out dates', 'error');
        return;
    }
    
    const nights = Math.floor((new Date(checkOut) - new Date(checkIn)) / (1000 * 60 * 60 * 24));
    if (nights <= 0) {
        e.preventDefault();
        showNotification('Check-out date must be after check-in date', 'error');
        return;
    }
    
    // Show loading state
    const btn = document.getElementById('reserveBtn');
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
    btn.disabled = true;
});
</script>
{% endblock %}